## 异步扣减库存
### 接口
1."/order/captcha":生成验证码接口，用于前端平滑流量；        
2."/order/token"：生成秒杀活动接口    
3."/order/create"：秒杀订单接口     


### Rockedmq事务型消息过程
![image](https://user-images.githubusercontent.com/52461848/170861787-5f1d0255-a333-4695-92a0-021775a3dfd0.png)

正常情况：    
1.生产者向MQ发送消息，此时是一个half消息    
2.MQ进行持久化，向生产者发送ACK确认消息接收成功    
3.生产者执行本地事务的逻辑    
4.生产者根据事务的执行状态（commit/rollback/unknown）发送给MQ    
异常情况：    
5.如果MQ超时未收到生产者根据事务的执行状态（步骤4），则进行消息回查
6.生产者收到回查消息，进行回查消息状态，检查本地事务的执行状态    
7.生成者根据回查的消息状态，发送给MQ，即重试步骤4    
8.提交消息，消费者进行消费

### 秒杀实现架构
![image](https://user-images.githubusercontent.com/52461848/168426934-9532f1da-f6de-4757-bfd3-dd61f126b10f.png)
